# iSpring_dwh

Репозиторий содержит вариант решения тестового задания на DataIngeneer в iSpring.

Для решения поставленных задач спроектирована и создана база данных database_dwh (MySQL 5.7).

Структура базы приведена на диаграмме ...

### Краткое описание ETL-модуля, реализованного на Python 3.8

Модуль состоит из 4 приложений:

**historical_rate.py** - взаимодействует с API ЦБ РФ, наполняет таблицу ***staging*** тестовыми данными по курсам валют за регулируемое количество дней.

**rate_checker.py** - взаимодействует с API ЦБ РФ, получает ежедневные курсы валют, 
записывает в таблицу ***staging***. Может запускаться по расписанию (пример для Cron: 0 12 * * * /path/to/file/rate_checker.sh)

**stage-to-core.py** - переносит данные в нормализованную таблицу ***core***. Может запускаться по расписанию с необходимой периодичностью.

**datamarts_maker.py** - рассчитывает курсы "все-ко-всем" на основе данных из ***core***, 
создаёт таблицу ***all_to_all***; формирует две "витрины" в соответствие с заданием: ***datamart1***(table), ***datamart2***(table).
Запускается по мере необходимости формирования витрин данных. Третья витрина ***datamart3*** создана в формате VIEW.

### Файлы проекта:

- **2021-06_Testovoe_zadanie_-_Data_Engineer.pdf** - тестовое задание.
- **_localhost-2021_06_29_12_09_33-dump.sql** - дамп базы database_dwh
- **database_dwh_*.sql** - SQL Inserts базы database_dwh
- **db_auth.py** - аутентификационные данные для доступа к базе database_dwh
- **erlog.txt** - лог ошибок скриптов (кодировка windows-1251)
- **historical_rate.py** - ETL-скрипт
- **rate_checker.py** - ETL-скрипт
- **stage-to-core.py** - ETL-скрипт
- **datamarts_maker.py** - ETL-скрипт


